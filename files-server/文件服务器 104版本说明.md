### 文件服务器 104版本说明

1. 版本更新说明 (104)

   ```
   1. 此版本存在文件负载不均匀情况;
   2. 增加zip 格式自动解压功能;
   3. 支持图片\js\css 等静态文件传输过程使用gzip 压缩;
   4. 上传过程限流;
   5. 增加负载能力;
   ```

   

2. 功能说明

   ```
   1. 上传：请参考file_upload.html ,文件服务器上传文件时有两种方式,一种是基于form 表单形式,前端对接时请使用此种方式. 
   2. 上传控制: 文件上传最大为1024M ,文件如果为图片,将使用UUID替换文件名.使用文件后缀控制,对于无法判断安全性的文件格式拒绝上传.
   3. 下载: 文件服务器对下载过程没有流量控制, 大量下载将影响文件系统性能.
   4. 剪切和压缩: 图片格式(bmp 除外)支持剪切\按比例缩小\压缩等.
   ```

   

3. 安装说明

   ```shell
   1. 文件服务器使用docker镜像方式推送到了公安产品线中心镜像仓库Habor (地址：) 
   
   2. 拉取容器 ： 运行命令 docker pull (habor 地址):tinker-files-server:1.0.6 
   
   3. 启动文件服务器： docker run -it -d --net=host --privileged=true --restart=always -v /home/files:/home/tinker/temp  -v /home/tinker/docker/file-server:/home/tinker/docker/file-server --name tinker-files-server tinker-file-server:v1.0.6;
   
   ```

   

4. 文件上传下载方法

   1. 上传 demo (html)

      ```
      <html>
      <head>
      <title>Test upload</title>
      </head>
      <body>
      <h2>Select files to upload</h2>
      <form name="upload" method="POST" enctype="multipart/form-data" action="http://192.168.37.193/upload">
      <input type="file" name="fffff" value="TEST"><br>
      <!-- <input type="file" name="21" value="TEST"><br>
      <input type="file" name="2222" value="TEST"><br>
      <input type="file" name="22222" value="TEST"><br> -->
      <input type="submit" name="submit" value="Upload">
      <input type="hidden" name="test" value="value">
      </form>
      </body>
      </html>
      ```

   2. 上传回调格式

      ```json
      {"desc":["20190508\/18cb75f8f6512a86959f8a4a8832a7ec.jpg"],"msg":"上传成功！","code":200,"diskstatus":{"diskspace":"775G\n","diskuse":"12%\n"},"file_orign_name":["IMG_20151111_120110212.jpg"],"server_verison":1006}
      ```

   3. 文件下载方法

      ````
      http://192.168.37.193/files/20190508/18cb75f8f6512a86959f8a4a8832a7ec.jpg
      ````

      

   4. 等比压缩图片获取

      ````
      http://192.168.37.193/img_200x200/20190508/18cb75f8f6512a86959f8a4a8832a7ec.jpg
      ````

      